<!--
* Copyright (c) 2010 The Chromium Authors. All rights reserved.  Use of this
* source code is governed by a BSD-style license that can be found in the
* LICENSE file.
*
* Author: Eric Bidelman <ericbidelman@chromium.org>
-->
<html>
  <head>
    <title>Options</title>
    <style type="text/css">
      body {
        font-family: Helvetica, Arial, sans-serif;
        font-size: small;
      }
    </style>
    <script type="text/javascript">
      var bgPage = chrome.extension.getBackgroundPage();

      function logout() {
        bgPage.logout();
        location.reload();
      }

      function setupSync() {
        if(!bgPage.oauth.hasToken()) {
          alert('Set up authentication first.');
          return;
        }
        if(!localStorage['gDoc']) {
          // alert('no exisiting entry');
          docentry = new bgPage.GoogleDoc();
          docentry.getRemoteDataFile();
          // alert(docentry);
          if(!localStorage['gDoc']) {
            docentry.createRemoteDataFile();
          }
        }
        // alert(localStorage['gDoc']);
        location.reload();
      }

      function clearSync() {
        localStorage.removeItem('gDoc');
        location.reload();
      }
      
      function clearLocalData() {
        localStorage.removeItem('pagenotes');
        location.reload();
      }

      function initUI() {
        if (!bgPage.oauth.hasToken()) {
          document.getElementById('revoke').disabled = true;
        } else {
          document.getElementById('get_auth_token').disabled = true;
        }
        if (localStorage['gDoc']) {
          document.getElementById('setup_sync').disabled = true;
        } else {
          document.getElementById('clear_sync').disabled = true;
        }
        if (!localStorage.getItem('pagenotes')) {
          document.getElementById('clear_local').disabled = true; 
        }
      }
    </script>
  </head>
  <body onload="initUI();">
    <button id="clear_local" onclick="clearLocalData();">
      Clear Local Data
    </button>
    <p>
      <button id="setup_sync" onclick="setupSync();">
        Setup Sync
      </button>
      <button id="clear_sync" onclick="clearSync();">
        Clear Sync
      </button>
    </p>
    <p>
      Authentication Settings:
    </p>
    <p style="margin-left:10px; margin-top:10px">
      <button id="get_auth_token" onclick="bgPage.oauth.authorize(function(){location.reload();});">
        Get Google Docs OAuth Token
      </button>
      <button id="revoke" onclick="logout();clearSync();">
        Revoke Google Docs OAuth Token
      </button>
    </p>
  </body>
</html>